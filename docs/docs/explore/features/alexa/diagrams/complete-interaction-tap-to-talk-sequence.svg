<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2343px" preserveAspectRatio="none" style="width:894px;height:2343px;background:#FFFFFF;" version="1.1" viewBox="0 0 894 2343" width="894px" zoomAndPan="magnify"><defs><filter height="300%" id="f1ib4tk2n0gm0k" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="none" height="26.29" style="stroke:none;stroke-width:1.0;" width="313" x="286.5" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="303" x="291.5" y="28.3369">Complete Alexa Interaction (Tap-to-Talk)</text><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="188.5" y="356.5918"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="188.5" y="562.73"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="188.5" y="957.5005"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="188.5" y="1060.0063"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="188.5" y="1232.6387"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="188.5" y="1407.3975"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="188.5" y="1566.0298"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="188.5" y="1755.915"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="188.5" y="2182.5591"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="479.5" y="298.3389"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="29.1265" style="stroke:#A80036;stroke-width:1.0;" width="10" x="479.5" y="414.8447"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="29.1265" style="stroke:#A80036;stroke-width:1.0;" width="10" x="479.5" y="1465.6504"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="479.5" y="1668.5356"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="479.5" y="2095.1797"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="132.6323" style="stroke:#000000;stroke-width:2.0;" width="741.5" x="135.5" y="752.4888"/><line style="stroke:#A80036;stroke-width:1.0;" x1="23" x2="23" y1="125.5801" y2="1948.6738"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="23" x2="23" y1="1948.6738" y2="1976.6738"/><line style="stroke:#A80036;stroke-width:1.0;" x1="23" x2="23" y1="1976.6738" y2="2258.812"/><line style="stroke:#A80036;stroke-width:1.0;" x1="193.5" x2="193.5" y1="125.5801" y2="1948.6738"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="193.5" x2="193.5" y1="1948.6738" y2="1976.6738"/><line style="stroke:#A80036;stroke-width:1.0;" x1="193.5" x2="193.5" y1="1976.6738" y2="2258.812"/><line style="stroke:#A80036;stroke-width:1.0;" x1="484" x2="484" y1="125.5801" y2="1948.6738"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="484" x2="484" y1="1948.6738" y2="1976.6738"/><line style="stroke:#A80036;stroke-width:1.0;" x1="484" x2="484" y1="1976.6738" y2="2258.812"/><line style="stroke:#A80036;stroke-width:1.0;" x1="838" x2="838" y1="125.5801" y2="1948.6738"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="838" x2="838" y1="1948.6738" y2="1976.6738"/><line style="stroke:#A80036;stroke-width:1.0;" x1="838" x2="838" y1="1976.6738" y2="2258.812"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="5" y="122.5928">User</text><ellipse cx="23.5" cy="52.29" fill="#FEFECE" filter="url(#f1ib4tk2n0gm0k)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M23.5,60.29 L23.5,87.29 M10.5,68.29 L36.5,68.29 M23.5,87.29 L10.5,102.29 M23.5,87.29 L36.5,102.29 " fill="none" filter="url(#f1ib4tk2n0gm0k)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="5" y="2271.1147">User</text><ellipse cx="23.5" cy="2284.1021" fill="#FEFECE" filter="url(#f1ib4tk2n0gm0k)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M23.5,2292.1021 L23.5,2319.1021 M10.5,2300.1021 L36.5,2300.1021 M23.5,2319.1021 L10.5,2334.1021 M23.5,2319.1021 L36.5,2334.1021 " fill="none" filter="url(#f1ib4tk2n0gm0k)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f1ib4tk2n0gm0k)" height="30.29" style="stroke:#A80036;stroke-width:1.5;" width="92" x="145.5" y="90.29"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="152.5" y="110.5928">Application</text><rect fill="#FEFECE" filter="url(#f1ib4tk2n0gm0k)" height="30.29" style="stroke:#A80036;stroke-width:1.5;" width="92" x="145.5" y="2257.812"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="152.5" y="2278.1147">Application</text><rect fill="#87CEFA" filter="url(#f1ib4tk2n0gm0k)" height="30.29" style="stroke:#A80036;stroke-width:1.5;" width="129" x="418" y="90.29"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115" x="425" y="110.5928">Auto SDK Engine</text><rect fill="#87CEFA" filter="url(#f1ib4tk2n0gm0k)" height="30.29" style="stroke:#A80036;stroke-width:1.5;" width="129" x="418" y="2257.812"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115" x="425" y="2278.1147">Auto SDK Engine</text><rect fill="#C9FFC9" filter="url(#f1ib4tk2n0gm0k)" height="30.29" style="stroke:#A80036;stroke-width:1.5;" width="53" x="810" y="90.29"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="817" y="110.5928">Alexa</text><rect fill="#C9FFC9" filter="url(#f1ib4tk2n0gm0k)" height="30.29" style="stroke:#A80036;stroke-width:1.5;" width="53" x="810" y="2257.812"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="817" y="2278.1147">Alexa</text><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="188.5" y="356.5918"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="188.5" y="562.73"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="188.5" y="957.5005"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="188.5" y="1060.0063"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="188.5" y="1232.6387"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="188.5" y="1407.3975"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="188.5" y="1566.0298"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="188.5" y="1755.915"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="188.5" y="2182.5591"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="479.5" y="298.3389"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="29.1265" style="stroke:#A80036;stroke-width:1.0;" width="10" x="479.5" y="414.8447"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="29.1265" style="stroke:#A80036;stroke-width:1.0;" width="10" x="479.5" y="1465.6504"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="479.5" y="1668.5356"/><rect fill="#FFFFFF" filter="url(#f1ib4tk2n0gm0k)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="479.5" y="2095.1797"/><path d="M107,140.5801 L107,165.5801 L275,165.5801 L275,150.5801 L265,140.5801 L107,140.5801 " fill="#FBFB77" filter="url(#f1ib4tk2n0gm0k)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M265,140.5801 L265,150.5801 L275,150.5801 L265,140.5801 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="113" y="157.9326">Alexa is in an idle state</text><rect fill="#EEEEEE" filter="url(#f1ib4tk2n0gm0k)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="887" x="0" y="195.2698"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="887" y1="195.2698" y2="195.2698"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="887" y1="198.2698" y2="198.2698"/><rect fill="#EEEEEE" filter="url(#f1ib4tk2n0gm0k)" height="23.1265" style="stroke:#000000;stroke-width:2.0;" width="147" x="370" y="184.7065"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="129" x="376" y="201.0908">User invokes Alexa</text><polygon fill="#A80036" points="181.5,250.0859,191.5,254.0859,181.5,258.0859,185.5,254.0859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="23.5" x2="187.5" y1="254.0859" y2="254.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="30.5" y="234.1855">tap and release Alexa</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="30.5" y="249.312">invocation button</text><polygon fill="#A80036" points="467.5,294.3389,477.5,298.3389,467.5,302.3389,471.5,298.3389" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="193.5" x2="473.5" y1="298.3389" y2="298.3389"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="254" x="200.5" y="278.4385">SpeechRecognizer.StartCapture message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="208.5" y="293.5649">initiator=TAP_TO_TALK</text><polygon fill="#A80036" points="204.5,308.3389,194.5,312.3389,204.5,316.3389,200.5,312.3389" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="198.5" x2="483.5" y1="312.3389" y2="312.3389"/><polygon fill="#A80036" points="209.5,352.5918,199.5,356.5918,209.5,360.5918,205.5,356.5918" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="203.5" x2="483.5" y1="356.5918" y2="356.5918"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232" x="215.5" y="336.6914">AudioInput.StartAudioInput message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="223.5" y="351.8179">audioType=SPEECH</text><polygon fill="#A80036" points="472.5,366.5918,482.5,370.5918,472.5,374.5918,476.5,370.5918" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="193.5" x2="478.5" y1="370.5918" y2="370.5918"/><polygon fill="#A80036" points="467.5,410.8447,477.5,414.8447,467.5,418.8447,471.5,414.8447" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="193.5" x2="473.5" y1="414.8447" y2="414.8447"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="200.5" y="394.9443">openStream()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="208.5" y="410.0708">mode=WRITE</text><polygon fill="#A80036" points="204.5,439.9712,194.5,443.9712,204.5,447.9712,200.5,443.9712" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="198.5" x2="483.5" y1="443.9712" y2="443.9712"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="210.5" y="439.1973">MessageStream</text><polygon fill="#A80036" points="826.5,514.4771,836.5,518.4771,826.5,522.4771,830.5,518.4771" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="484.5" x2="832.5" y1="518.4771" y2="518.4771"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219" x="491.5" y="468.3237">SpeechRecognizer.Recognize event</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="491.5" y="483.4502">(pt. 1 - JSON)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="499.5" y="498.5767">initiator.type=TAP,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="499.5" y="513.7031">profile=NEAR_FIELD</text><polygon fill="#A80036" points="209.5,558.73,199.5,562.73,209.5,566.73,205.5,562.73" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="203.5" x2="483.5" y1="562.73" y2="562.73"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="262" x="215.5" y="542.8296">AlexaClient.DialogStateChanged message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="223.5" y="557.9561">state=LISTENING</text><polygon fill="#A80036" points="472.5,572.73,482.5,576.73,472.5,580.73,476.5,576.73" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="193.5" x2="478.5" y1="576.73" y2="576.73"/><polygon fill="#A80036" points="34.5,616.9829,24.5,620.9829,34.5,624.9829,30.5,620.9829" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="28.5" x2="192.5" y1="620.9829" y2="620.9829"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="40.5" y="601.0825">play start of listening</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42" x="40.5" y="616.209">earcon</text><polygon fill="#A80036" points="34.5,661.2358,24.5,665.2358,34.5,669.2358,30.5,665.2358" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="28.5" x2="192.5" y1="665.2358" y2="665.2358"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="40.5" y="645.3354">display listening</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="40.5" y="660.4619">voice chrome</text><rect fill="#EEEEEE" filter="url(#f1ib4tk2n0gm0k)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="887" x="0" y="693.7991"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="887" y1="693.7991" y2="693.7991"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="887" y1="696.7991" y2="696.7991"/><rect fill="#EEEEEE" filter="url(#f1ib4tk2n0gm0k)" height="23.1265" style="stroke:#000000;stroke-width:2.0;" width="159" x="364" y="683.2358"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="141" x="370" y="699.6201">User speaks to Alexa</text><polygon fill="#A80036" points="181.5,733.4888,191.5,737.4888,181.5,741.4888,185.5,737.4888" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="23.5" x2="187.5" y1="737.4888" y2="737.4888"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="30.5" y="732.7148">start speaking to Alexa</text><path d="M135.5,752.4888 L209.5,752.4888 L209.5,759.4888 L199.5,769.4888 L135.5,769.4888 L135.5,752.4888 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="132.6323" style="stroke:#000000;stroke-width:2.0;" width="741.5" x="135.5" y="752.4888"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="150.5" y="765.873">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="176" x="224.5" y="764.9678">[until StopAudioInput message]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="193.5" x2="235.5" y1="790.7417" y2="790.7417"/><line style="stroke:#A80036;stroke-width:1.0;" x1="235.5" x2="235.5" y1="790.7417" y2="803.7417"/><line style="stroke:#A80036;stroke-width:1.0;" x1="194.5" x2="235.5" y1="803.7417" y2="803.7417"/><polygon fill="#A80036" points="204.5,799.7417,194.5,803.7417,204.5,807.7417,200.5,803.7417" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="200.5" y="785.9678">record mic data</text><polygon fill="#A80036" points="472.5,828.8682,482.5,832.8682,472.5,836.8682,476.5,832.8682" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="193.5" x2="478.5" y1="832.8682" y2="832.8682"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="200.5" y="828.0942">write data to MessageStream</text><polygon fill="#A80036" points="826.5,873.1211,836.5,877.1211,826.5,881.1211,830.5,877.1211" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="484.5" x2="832.5" y1="877.1211" y2="877.1211"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219" x="491.5" y="857.2207">SpeechRecognizer.Recognize event</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="491.5" y="872.3472">(pt. 2 - binary audio chunks)</text><polygon fill="#A80036" points="495.5,909.2476,485.5,913.2476,495.5,917.2476,491.5,913.2476" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="489.5" x2="837.5" y1="913.2476" y2="913.2476"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252" x="501.5" y="908.4736">SpeechRecognizer.StopCapture directive</text><polygon fill="#A80036" points="209.5,953.5005,199.5,957.5005,209.5,961.5005,205.5,957.5005" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="203.5" x2="483.5" y1="957.5005" y2="957.5005"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255" x="215.5" y="937.6001">SpeechRecognizer.EndOfSpeechDetected</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="215.5" y="952.7266">message</text><polygon fill="#A80036" points="472.5,967.5005,482.5,971.5005,472.5,975.5005,476.5,971.5005" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="193.5" x2="478.5" y1="971.5005" y2="971.5005"/><polygon fill="#A80036" points="34.5,1011.7534,24.5,1015.7534,34.5,1019.7534,30.5,1015.7534" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="28.5" x2="192.5" y1="1015.7534" y2="1015.7534"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="40.5" y="995.853">play end of listening</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42" x="40.5" y="1010.9795">earcon</text><polygon fill="#A80036" points="209.5,1056.0063,199.5,1060.0063,209.5,1064.0063,205.5,1060.0063" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="203.5" x2="483.5" y1="1060.0063" y2="1060.0063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="215.5" y="1040.106">AudioInput.StopAudioInput</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="215.5" y="1055.2324">message</text><polygon fill="#A80036" points="472.5,1070.0063,482.5,1074.0063,472.5,1078.0063,476.5,1074.0063" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="193.5" x2="478.5" y1="1074.0063" y2="1074.0063"/><line style="stroke:#A80036;stroke-width:1.0;" x1="193.5" x2="235.5" y1="1103.1328" y2="1103.1328"/><line style="stroke:#A80036;stroke-width:1.0;" x1="235.5" x2="235.5" y1="1103.1328" y2="1116.1328"/><line style="stroke:#A80036;stroke-width:1.0;" x1="194.5" x2="235.5" y1="1116.1328" y2="1116.1328"/><polygon fill="#A80036" points="204.5,1112.1328,194.5,1116.1328,204.5,1120.1328,200.5,1116.1328" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="200.5" y="1098.3589">close mic</text><rect fill="#EEEEEE" filter="url(#f1ib4tk2n0gm0k)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="887" x="0" y="1144.696"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="887" y1="1144.696" y2="1144.696"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="887" y1="1147.696" y2="1147.696"/><rect fill="#EEEEEE" filter="url(#f1ib4tk2n0gm0k)" height="23.1265" style="stroke:#000000;stroke-width:2.0;" width="187" x="350" y="1134.1328"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="169" x="356" y="1150.5171">Alexa prepares response</text><polygon fill="#A80036" points="495.5,1184.3857,485.5,1188.3857,495.5,1192.3857,491.5,1188.3857" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="489.5" x2="837.5" y1="1188.3857" y2="1188.3857"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="330" x="501.5" y="1183.6118">InteractionModel.RequestProcessingStarted directive</text><polygon fill="#A80036" points="209.5,1228.6387,199.5,1232.6387,209.5,1236.6387,205.5,1232.6387" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="203.5" x2="483.5" y1="1232.6387" y2="1232.6387"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="262" x="215.5" y="1212.7383">AlexaClient.DialogStateChanged message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="223.5" y="1227.8647">state=THINKING</text><polygon fill="#A80036" points="472.5,1242.6387,482.5,1246.6387,472.5,1250.6387,476.5,1246.6387" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="193.5" x2="478.5" y1="1246.6387" y2="1246.6387"/><polygon fill="#A80036" points="34.5,1286.8916,24.5,1290.8916,34.5,1294.8916,30.5,1290.8916" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="28.5" x2="192.5" y1="1290.8916" y2="1290.8916"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="40.5" y="1270.9912">Display thinking</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="40.5" y="1286.1177">voice chrome</text><rect fill="#EEEEEE" filter="url(#f1ib4tk2n0gm0k)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="887" x="0" y="1319.4548"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="887" y1="1319.4548" y2="1319.4548"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="887" y1="1322.4548" y2="1322.4548"/><rect fill="#EEEEEE" filter="url(#f1ib4tk2n0gm0k)" height="23.1265" style="stroke:#000000;stroke-width:2.0;" width="174" x="356.5" y="1308.8916"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="156" x="362.5" y="1325.2759">Alexa responds to user</text><polygon fill="#A80036" points="495.5,1359.1445,485.5,1363.1445,495.5,1367.1445,491.5,1363.1445" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="489.5" x2="837.5" y1="1363.1445" y2="1363.1445"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215" x="501.5" y="1358.3706">SpeechSynthesizer.Speak directive</text><polygon fill="#A80036" points="209.5,1403.3975,199.5,1407.3975,209.5,1411.3975,205.5,1407.3975" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="203.5" x2="483.5" y1="1407.3975" y2="1407.3975"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="215.5" y="1387.4971">AudioOutput.Prepare message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="223.5" y="1402.6235">source=STREAM</text><polygon fill="#A80036" points="472.5,1417.3975,482.5,1421.3975,472.5,1425.3975,476.5,1421.3975" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="193.5" x2="478.5" y1="1421.3975" y2="1421.3975"/><polygon fill="#A80036" points="467.5,1461.6504,477.5,1465.6504,467.5,1469.6504,471.5,1465.6504" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="193.5" x2="473.5" y1="1465.6504" y2="1465.6504"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="200.5" y="1445.75">openStream()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="208.5" y="1460.8765">mode=READ</text><polygon fill="#A80036" points="204.5,1490.7769,194.5,1494.7769,204.5,1498.7769,200.5,1494.7769" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="198.5" x2="483.5" y1="1494.7769" y2="1494.7769"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="210.5" y="1490.0029">MessageStream</text><line style="stroke:#A80036;stroke-width:1.0;" x1="193.5" x2="235.5" y1="1523.9033" y2="1523.9033"/><line style="stroke:#A80036;stroke-width:1.0;" x1="235.5" x2="235.5" y1="1523.9033" y2="1536.9033"/><line style="stroke:#A80036;stroke-width:1.0;" x1="194.5" x2="235.5" y1="1536.9033" y2="1536.9033"/><polygon fill="#A80036" points="204.5,1532.9033,194.5,1536.9033,204.5,1540.9033,200.5,1536.9033" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="200.5" y="1519.1294">buffer stream content</text><polygon fill="#A80036" points="209.5,1562.0298,199.5,1566.0298,209.5,1570.0298,205.5,1566.0298" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="203.5" x2="483.5" y1="1566.0298" y2="1566.0298"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="215.5" y="1561.2559">AudioOutput.Play message</text><polygon fill="#A80036" points="472.5,1576.0298,482.5,1580.0298,472.5,1584.0298,476.5,1580.0298" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="193.5" x2="478.5" y1="1580.0298" y2="1580.0298"/><polygon fill="#A80036" points="34.5,1620.2827,24.5,1624.2827,34.5,1628.2827,30.5,1624.2827" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="28.5" x2="192.5" y1="1624.2827" y2="1624.2827"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113" x="40.5" y="1604.3823">play Alexa speech</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="40.5" y="1619.5088">from stream</text><polygon fill="#A80036" points="467.5,1664.5356,477.5,1668.5356,467.5,1672.5356,471.5,1668.5356" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="193.5" x2="473.5" y1="1668.5356" y2="1668.5356"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267" x="200.5" y="1648.6353">AudioOutput.MediaStateChanged message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="208.5" y="1663.7617">state=PLAYING</text><polygon fill="#A80036" points="204.5,1678.5356,194.5,1682.5356,204.5,1686.5356,200.5,1682.5356" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="198.5" x2="483.5" y1="1682.5356" y2="1682.5356"/><polygon fill="#A80036" points="826.5,1707.6621,836.5,1711.6621,826.5,1715.6621,830.5,1711.6621" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="484.5" x2="832.5" y1="1711.6621" y2="1711.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="246" x="491.5" y="1706.8882">SpeechSynthesizer.SpeechStarted event</text><polygon fill="#A80036" points="209.5,1751.915,199.5,1755.915,209.5,1759.915,205.5,1755.915" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="203.5" x2="483.5" y1="1755.915" y2="1755.915"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="262" x="215.5" y="1736.0146">AlexaClient.DialogStateChanged message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="223.5" y="1751.1411">state=SPEAKING</text><polygon fill="#A80036" points="472.5,1765.915,482.5,1769.915,472.5,1773.915,476.5,1769.915" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="193.5" x2="478.5" y1="1769.915" y2="1769.915"/><polygon fill="#A80036" points="34.5,1810.168,24.5,1814.168,34.5,1818.168,30.5,1814.168" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="28.5" x2="192.5" y1="1814.168" y2="1814.168"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="40.5" y="1794.2676">display speaking</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="40.5" y="1809.394">voice chrome</text><path d="M355,1827.168 L355,1852.168 L829,1852.168 L829,1837.168 L819,1827.168 L355,1827.168 " fill="#FBFB77" filter="url(#f1ib4tk2n0gm0k)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M819,1827.168 L819,1837.168 L829,1837.168 L819,1827.168 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="453" x="361" y="1844.5205">Alexa sends additional directives depending on what the user requested</text><polygon fill="#A80036" points="495.5,1878.4209,485.5,1882.4209,495.5,1886.4209,491.5,1882.4209" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="489.5" x2="837.5" y1="1882.4209" y2="1882.4209"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="501.5" y="1877.647">&lt;&lt;details omitted&gt;&gt;</text><polygon fill="#A80036" points="204.5,1907.5474,194.5,1911.5474,204.5,1915.5474,200.5,1911.5474" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="198.5" x2="483.5" y1="1911.5474" y2="1911.5474"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="210.5" y="1906.7734">&lt;&lt;details omitted&gt;&gt;</text><polygon fill="#A80036" points="34.5,1936.6738,24.5,1940.6738,34.5,1944.6738,30.5,1940.6738" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="28.5" x2="192.5" y1="1940.6738" y2="1940.6738"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="40.5" y="1935.8999">&lt;&lt;details omitted&gt;&gt;</text><rect fill="#EEEEEE" filter="url(#f1ib4tk2n0gm0k)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="887" x="0" y="1997.2371"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="887" y1="1997.2371" y2="1997.2371"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="887" y1="2000.2371" y2="2000.2371"/><rect fill="#EEEEEE" filter="url(#f1ib4tk2n0gm0k)" height="23.1265" style="stroke:#000000;stroke-width:2.0;" width="128" x="379.5" y="1986.6738"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110" x="385.5" y="2003.0581">Interaction ends</text><path d="M106,2024.8003 L106,2049.8003 L277,2049.8003 L277,2034.8003 L267,2024.8003 L106,2024.8003 " fill="#FBFB77" filter="url(#f1ib4tk2n0gm0k)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M267,2024.8003 L267,2034.8003 L277,2034.8003 L267,2024.8003 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="112" y="2042.1528">Alexa finishes speaking</text><polygon fill="#A80036" points="467.5,2091.1797,477.5,2095.1797,467.5,2099.1797,471.5,2095.1797" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="193.5" x2="473.5" y1="2095.1797" y2="2095.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267" x="200.5" y="2075.2793">AudioOutput.MediaStateChanged message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="208.5" y="2090.4058">state=STOPPED</text><polygon fill="#A80036" points="204.5,2105.1797,194.5,2109.1797,204.5,2113.1797,200.5,2109.1797" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="198.5" x2="483.5" y1="2109.1797" y2="2109.1797"/><polygon fill="#A80036" points="826.5,2134.3062,836.5,2138.3062,826.5,2142.3062,830.5,2138.3062" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="484.5" x2="832.5" y1="2138.3062" y2="2138.3062"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255" x="491.5" y="2133.5322">SpeechSynthesizer.SpeechFinished event</text><polygon fill="#A80036" points="209.5,2178.5591,199.5,2182.5591,209.5,2186.5591,205.5,2182.5591" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="203.5" x2="483.5" y1="2182.5591" y2="2182.5591"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="262" x="215.5" y="2162.6587">AlexaClient.DialogStateChanged message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="223.5" y="2177.7852">state=IDLE</text><polygon fill="#A80036" points="472.5,2192.5591,482.5,2196.5591,472.5,2200.5591,476.5,2196.5591" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="193.5" x2="478.5" y1="2196.5591" y2="2196.5591"/><polygon fill="#A80036" points="34.5,2236.812,24.5,2240.812,34.5,2244.812,30.5,2240.812" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="28.5" x2="192.5" y1="2240.812" y2="2240.812"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="40.5" y="2220.9116">dismiss</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="40.5" y="2236.0381">voice chrome</text><!--MD5=[9e94153215692ea02c78eb53d7a55c49]
@startuml
title: Complete Alexa Interaction (Tap-to-Talk)

skinparam roundcorner 10
skinparam sequenceMessageAlign center
<style>
sequenceDiagram {
    .engine {
        BackgroundColor LightSkyBlue
        BorderColor CornflowerBlue
    }
    .avs {
        BackgroundColor TECHNOLOGY
        BorderColor Green
    }
}
</style>


actor User Order 10
participant Application  order 30
participant "Auto SDK Engine" as Engine <<engine>> order 40
participant "Alexa" as Alexa <<avs>> order 50


note over Application
Alexa is in an idle state
end note

== User invokes Alexa ==


User -> Application: tap and release Alexa\ninvocation button
Application -> Engine : SpeechRecognizer.StartCapture message\n  initiator=TAP_TO_TALK
activate Engine
Engine - -> Application 
deactivate Engine

Engine -> Application: AudioInput.StartAudioInput message \n  audioType=SPEECH
activate Application
Application - -> Engine
deactivate Application


Application -> Engine: openStream()\n  mode=WRITE
activate Engine
Engine - -> Application: MessageStream
deactivate Engine

Engine -> Alexa: SpeechRecognizer.Recognize event \n(pt. 1 - JSON)\n  initiator.type=TAP,\n  profile=NEAR_FIELD


Engine -> Application: AlexaClient.DialogStateChanged message \n  state=LISTENING
activate Application
Application - -> Engine
deactivate Application
Application -> User : play start of listening \nearcon
Application -> User : display listening \nvoice chrome


== User speaks to Alexa ==

User -> Application: start speaking to Alexa

loop until StopAudioInput message
  Application -> Application : record mic data
  Application -> Engine: write data to MessageStream
  Engine -> Alexa: SpeechRecognizer.Recognize event \n(pt. 2 - binary audio chunks)
end

Alexa -> Engine: SpeechRecognizer.StopCapture directive
Engine -> Application: SpeechRecognizer.EndOfSpeechDetected \nmessage
activate Application
Application - -> Engine
deactivate Application
Application -> User : play end of listening \nearcon


Engine -> Application: AudioInput.StopAudioInput \nmessage
activate Application
Application - -> Engine
deactivate Application
Application->Application : close mic


== Alexa prepares response ==

Alexa -> Engine: InteractionModel.RequestProcessingStarted directive
Engine -> Application: AlexaClient.DialogStateChanged message \n  state=THINKING
activate Application
Application- ->Engine
deactivate Application
Application -> User : Display thinking \nvoice chrome


== Alexa responds to user ==

Alexa -> Engine: SpeechSynthesizer.Speak directive
Engine -> Application : AudioOutput.Prepare message\n  source=STREAM
activate Application
Application - -> Engine
deactivate Application

Application -> Engine: openStream()\n  mode=READ
activate Engine
Engine - -> Application: MessageStream
deactivate Engine
Application -> Application : buffer stream content


Engine -> Application : AudioOutput.Play message
activate Application
Application - -> Engine
deactivate Application

Application -> User : play Alexa speech\nfrom stream
Application -> Engine : AudioOutput.MediaStateChanged message\n  state=PLAYING
activate Engine
Engine - -> Application
deactivate Engine
Engine -> Alexa : SpeechSynthesizer.SpeechStarted event


Engine -> Application : AlexaClient.DialogStateChanged message\n  state=SPEAKING
activate Application
Application - -> Engine
deactivate Application
Application -> User : display speaking\nvoice chrome

note left of Alexa
Alexa sends additional directives depending on what the user requested
end note
Alexa->Engine: <<details omitted>>
Engine->Application: <<details omitted>>
Application->User: <<details omitted>>

...

== Interaction ends ==

note over Application
Alexa finishes speaking
end note

Application -> Engine : AudioOutput.MediaStateChanged message\n  state=STOPPED
activate Engine
Engine - -> Application
deactivate Engine
Engine -> Alexa : SpeechSynthesizer.SpeechFinished event

Engine -> Application : AlexaClient.DialogStateChanged message\n  state=IDLE
activate Application
Application - -> Engine
deactivate Application
Application -> User : dismiss \nvoice chrome
@enduml

PlantUML version 1.2021.12(Tue Oct 05 16:01:58 UTC 2021)
(GPLV2 source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>